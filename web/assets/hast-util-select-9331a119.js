import{s as S,f as H,h as T}from"./property-information-33d7f5d8.js";import{c as L}from"./css-selector-parser-8b709f9f.js";import{d as B}from"./direction-ad776bdc.js";import{t as $}from"./hast-util-to-string-00227f59.js";import{v as A}from"./unist-util-visit-4a8cdef4.js";import{E as Q,S as R}from"./unist-util-visit-parents-9b4d9404.js";import{s as j,p as F}from"./comma-separated-tokens-495b557e.js";import{o as d}from"./devlop-d057c9d1.js";import{p as z,s as D}from"./space-separated-tokens-eedf1754.js";import{e as M}from"./bcp-47-match-575b2c5d.js";import{n as x}from"./nth-check-c1dafc58.js";import{z as U}from"./zwitch-18fef54d.js";import{h as m}from"./hast-util-has-property-d1e39f7e.js";import{w as V}from"./hast-util-whitespace-675c549c.js";const K=L({syntax:"selectors-4"});function W(e){if(typeof e!="string")throw new TypeError("Expected `string` as selector, not `"+e+"`");return K(e)}function X(e,n){const r=e.schema,o=e.language,t=e.direction,i=e.editableOrEditingHost;let a;if(n.type==="element"){const u=n.properties.xmlLang||n.properties.lang,c=n.properties.type||"text",p=w(n);u!=null&&(e.language=String(u)),r&&r.space==="html"?(n.properties.contentEditable==="true"&&(e.editableOrEditingHost=!0),n.tagName==="svg"&&(e.schema=S),p==="rtl"?a=p:p==="ltr"||p!=="auto"&&n.tagName==="html"||p!=="auto"&&n.tagName==="input"&&c==="tel"?a="ltr":(p==="auto"||n.tagName==="bdi")&&(n.tagName==="textarea"?a=y($(n)):n.tagName==="input"&&(c==="email"||c==="search"||c==="tel"||c==="text")?a=n.properties.value?y(String(n.properties.value)):"ltr":A(n,s)),a&&(e.direction=a)):e.editableOrEditingHost&&(e.editableOrEditingHost=!1)}return l;function l(){e.schema=r,e.language=o,e.direction=t,e.editableOrEditingHost=i}function s(u){if(u.type==="text")return a=y(u.value),a?Q:void 0;if(u!==n&&u.type==="element"&&(u.tagName==="bdi"||u.tagName==="script"||u.tagName==="style"||u.tagName==="textare"||w(u)))return R}}function y(e){const n=B(e);return n==="neutral"?void 0:n}function w(e){const n=e.type==="element"&&typeof e.properties.dir=="string"?e.properties.dir.toLowerCase():void 0;return n==="auto"||n==="ltr"||n==="rtl"?n:void 0}function G(e,n,r){const o=H(r,e.name),t=n.properties[o.property];let i=J(t,o);if(!e.value)return i!==void 0;d(e.value.type==="String");let a=e.value.value;if(e.caseSensitivityModifier==="i"&&(a=a.toLowerCase(),i&&(i=i.toLowerCase())),i!==void 0)switch(e.operator){case"=":return a===i;case"$=":return a===i.slice(-a.length);case"*=":return i.includes(a);case"^=":return a===i.slice(0,a.length);case"|=":return a===i||a===i.slice(0,a.length)&&i.charAt(a.length)==="-";case"~=":return a===i||z(i).includes(a)}return!1}function J(e,n){if(e!=null)if(typeof e=="boolean"){if(e)return n.attribute}else if(Array.isArray(e)){if(e.length>0)return(n.commaSeparated?j:D)(e)}else return String(e)}const Y=[];function Z(e,n){return(n.properties.className||Y).includes(e.name)}function q(e,n){return n.properties.id===e.name}function ee(e,n){return e.name===n.tagName}const ne=x.default||x,te=U("name",{handlers:{"any-link":re,blank:ie,checked:oe,dir:ae,disabled:E,empty:ue,enabled:le,"first-child":se,"first-of-type":ce,has:fe,is:I,lang:pe,"last-child":me,"last-of-type":ge,not:he,"nth-child":ye,"nth-last-child":_e,"nth-last-of-type":be,"nth-of-type":Ne,"only-child":xe,"only-of-type":we,optional:Ce,"read-only":Se,"read-write":k,required:v,root:Ee,scope:Ie},invalid:de,unknown:ke});function re(e,n){return(n.tagName==="a"||n.tagName==="area"||n.tagName==="link")&&m(n,"href")}function f(e,n){if(e.shallow)throw new Error("Cannot use `:"+n.name+"` without parent")}function ie(e,n){return!O(n,r);function r(o){return o.type==="element"||o.type==="text"&&!V(o)}}function oe(e,n){return n.tagName==="input"||n.tagName==="menuitem"?!!((n.properties.type==="checkbox"||n.properties.type==="radio")&&m(n,"checked")):n.tagName==="option"?m(n,"selected"):!1}function ae(e,n,r,o,t){return d(e.argument),d(e.argument.type==="String"),t.direction===e.argument.value}function E(e,n){return(n.tagName==="button"||n.tagName==="input"||n.tagName==="select"||n.tagName==="textarea"||n.tagName==="optgroup"||n.tagName==="option"||n.tagName==="menuitem"||n.tagName==="fieldset")&&m(n,"disabled")}function ue(e,n){return!O(n,r);function r(o){return o.type==="element"||o.type==="text"}}function le(e,n){return!E(e,n)}function se(e,n,r,o,t){return f(t,e),t.elementIndex===0}function ce(e,n,r,o,t){return f(t,e),t.typeIndex===0}function h(e){let n=e._cachedFn;if(!n){const r=e.argument;if(r.type!=="Formula")throw new Error("Expected `nth` formula, such as `even` or `2n+1` (`of` is not yet supported)");n=ne(r.a+"n+"+r.b),e._cachedFn=n}return n}function fe(e,n,r,o,t){d(e.argument),d(e.argument.type==="Selector");const i={...t,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[n],shallow:!1};return b(i,{type:"root",children:n.children}),i.results.length>0}function de(){}function I(e,n,r,o,t){d(e.argument),d(e.argument.type==="Selector");const i={...t,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[n],shallow:!1};return b(i,n),i.results[0]===n}function pe(e,n,r,o,t){return d(e.argument),d(e.argument.type==="String"),t.language!==""&&t.language!==void 0&&M(t.language,F(e.argument.value)).length>0}function me(e,n,r,o,t){return f(t,e),!!(t.elementCount&&t.elementIndex===t.elementCount-1)}function ge(e,n,r,o,t){return f(t,e),typeof t.typeIndex=="number"&&typeof t.typeCount=="number"&&t.typeIndex===t.typeCount-1}function he(e,n,r,o,t){return!I(e,n,r,o,t)}function ye(e,n,r,o,t){const i=h(e);return f(t,e),typeof t.elementIndex=="number"&&i(t.elementIndex)}function _e(e,n,r,o,t){const i=h(e);return f(t,e),!!(typeof t.elementCount=="number"&&typeof t.elementIndex=="number"&&i(t.elementCount-t.elementIndex-1))}function be(e,n,r,o,t){const i=h(e);return f(t,e),typeof t.typeCount=="number"&&typeof t.typeIndex=="number"&&i(t.typeCount-1-t.typeIndex)}function Ne(e,n,r,o,t){const i=h(e);return f(t,e),typeof t.typeIndex=="number"&&i(t.typeIndex)}function xe(e,n,r,o,t){return f(t,e),t.elementCount===1}function we(e,n,r,o,t){return f(t,e),t.typeCount===1}function Ce(e,n){return!v(e,n)}function Se(e,n,r,o,t){return!k(e,n,r,o,t)}function k(e,n,r,o,t){return n.tagName==="input"||n.tagName==="textarea"?!m(n,"readOnly")&&!m(n,"disabled"):!!t.editableOrEditingHost}function v(e,n){return(n.tagName==="input"||n.tagName==="textarea"||n.tagName==="select")&&m(n,"required")}function Ee(e,n,r,o,t){return!!((!o||o.type==="root")&&t.schema&&(t.schema.space==="html"||t.schema.space==="svg")&&(n.tagName==="html"||n.tagName==="svg"))}function Ie(e,n,r,o,t){return t.scopeElements.includes(n)}function O(e,n){const r=e.children;let o=-1;for(;++o<r.length;)if(n(r[o]))return!0;return!1}function ke(e){const n=e;throw new Error("Unknown pseudo-selector `"+n.name+"`")}function ve(e,n,r,o,t){for(const i of e.items)if(i.type==="Attribute"){if(!G(i,n,t.schema))return!1}else if(i.type==="Id"){if(!q(i,n))return!1}else if(i.type==="ClassName"){if(!Z(i,n))return!1}else if(i.type==="PseudoClass"){if(!te(i,n,r,o,t))return!1}else{if(i.type==="PseudoElement")throw new Error("Invalid selector: `::"+i.name+"`");if(i.type==="TagName"&&!ee(i,n))return!1}return!0}const Oe=[];function b(e,n){n&&P(e,[],n,void 0,void 0,n)}function _(e,n,r){const o=e[n];o?o.push(r):e[n]=[r]}function Pe(e,n,r,o){const t=g(n.descendant,n.directChild);let i,a=-1;const l={count:0,types:new Map},s={count:0,types:new Map};for(;++a<r.children.length;)C(l,r.children[a]);for(a=-1;++a<r.children.length;){const u=r.children[a],c=u.type==="element"?u.tagName.toUpperCase():void 0;if(e.elementIndex=s.count,e.typeIndex=c&&s.types.get(c)||0,e.elementCount=l.count,e.typeCount=c?l.types.get(c):0,"children"in u){const p=g(t,i),N=P(e,p,r.children[a],a,r,o);i=g(N.generalSibling,N.adjacentSibling)}if(e.one&&e.found)break;C(s,r.children[a])}}function He(e,n,r,o,t){const i={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0};let a=-1;for(;++a<n.length;){const l=n[a];if(e.one&&e.found)break;if(e.shallow&&l.nestedRule)throw new Error("Expected selector without nesting");if(ve(l,r,o,t,e)){const s=l.nestedRule;if(s){const u=s.combinator==="+"?"adjacentSibling":s.combinator==="~"?"generalSibling":s.combinator===">"?"directChild":"descendant";_(i,u,s)}else e.found=!0,e.results.includes(r)||e.results.push(r)}l.combinator===void 0?_(i,"descendant",l):l.combinator==="~"&&_(i,"generalSibling",l)}return i}function g(e,n){return e&&n&&e.length>0&&n.length>0?[...e,...n]:e&&e.length>0?e:n&&n.length>0?n:Oe}function C(e,n){if(n.type==="element"){const r=n.tagName.toUpperCase(),o=(e.types.get(r)||0)+1;e.count++,e.types.set(r,o)}}function P(e,n,r,o,t,i){let a={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0};const l=X(e,r);if(r.type==="element"){let s=e.rootQuery.rules;t&&t!==i&&(s=e.rootQuery.rules.filter(u=>u.combinator===void 0||u.combinator===">"&&t===i)),a=He(e,g(n,s),r,o,t)}return"children"in r&&!e.shallow&&!(e.one&&e.found)&&Pe(e,a,r,i),l(),a}function We(e,n,r){const o=Te(e,n,r);return b(o,n||void 0),o.results}function Te(e,n,r){return{direction:"ltr",editableOrEditingHost:!1,elementCount:void 0,elementIndex:void 0,found:!1,language:void 0,one:!1,results:[],rootQuery:W(e),schema:r==="svg"?S:T,scopeElements:n?n.type==="root"?n.children:[n]:[],shallow:!1,typeIndex:void 0,typeCount:void 0}}export{We as s};
