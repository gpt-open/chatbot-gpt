function R(t){if(typeof t!="string"||!t)throw new Error("expected a non-empty string, got: "+t)}function q(t){if(typeof t!="number")throw new Error("expected a number, got: "+t)}const rt=1,st=1,A="emoji",D="keyvalue",ae="favorites",at="tokens",Te="tokens",ct="unicode",Se="count",dt="group",lt="order",xe="group-order",ne="eTag",W="url",ge="skinTone",O="readonly",ce="readwrite",Ce="skinUnicodes",ut="skinUnicodes",ft="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",mt="en";function pt(t,e){const n=new Set,i=[];for(const r of t){const o=e(r);n.has(o)||(n.add(o),i.push(r))}return i}function be(t){return pt(t,e=>e.unicode)}function ht(t){function e(n,i,r){const o=i?t.createObjectStore(n,{keyPath:i}):t.createObjectStore(n);if(r)for(const[a,[m,f]]of Object.entries(r))o.createIndex(a,m,{multiEntry:f});return o}e(D),e(A,ct,{[Te]:[at,!0],[xe]:[[dt,lt]],[Ce]:[ut,!0]}),e(ae,void 0,{[Se]:[""]})}const oe={},z={},G={};function _e(t,e,n){n.onerror=()=>e(n.error),n.onblocked=()=>e(new Error("IDB blocked")),n.onsuccess=()=>t(n.result)}async function gt(t){const e=await new Promise((n,i)=>{const r=indexedDB.open(t,rt);oe[t]=r,r.onupgradeneeded=o=>{o.oldVersion<st&&ht(r.result)},_e(n,i,r)});return e.onclose=()=>de(t),e}function bt(t){return z[t]||(z[t]=gt(t)),z[t]}function _(t,e,n,i){return new Promise((r,o)=>{const a=t.transaction(e,n,{durability:"relaxed"}),m=typeof e=="string"?a.objectStore(e):e.map(c=>a.objectStore(c));let f;i(m,a,c=>{f=c}),a.oncomplete=()=>r(f),a.onerror=()=>o(a.error)})}function de(t){const e=oe[t],n=e&&e.result;if(n){n.close();const i=G[t];if(i)for(const r of i)r()}delete oe[t],delete z[t],delete G[t]}function yt(t){return new Promise((e,n)=>{de(t);const i=indexedDB.deleteDatabase(t);_e(e,n,i)})}function kt(t,e){let n=G[t];n||(n=G[t]=[]),n.push(e)}const Et=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function L(t){return t.split(/[\s_]+/).map(e=>!e.match(/\w/)||Et.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/‚Äô/g,"'").toLowerCase()).filter(Boolean)}const vt=2;function Ie(t){return t.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=vt)}function wt(t){return t.map(({annotation:n,emoticon:i,group:r,order:o,shortcodes:a,skins:m,tags:f,emoji:c,version:l})=>{const p=[...new Set(Ie([...(a||[]).map(L).flat(),...f.map(L).flat(),...L(n),i]))].sort(),u={annotation:n,group:r,order:o,tags:f,tokens:p,unicode:c,version:l};if(i&&(u.emoticon=i),a&&(u.shortcodes=a),m){u.skinTones=[],u.skinUnicodes=[],u.skinVersions=[];for(const{tone:b,emoji:C,version:j}of m)u.skinTones.push(b),u.skinUnicodes.push(C),u.skinVersions.push(j)}return u})}function Ae(t,e,n,i){t[e](n).onsuccess=r=>i&&i(r.target.result)}function I(t,e,n){Ae(t,"get",e,n)}function Le(t,e,n){Ae(t,"getAll",e,n)}function le(t){t.commit&&t.commit()}function jt(t,e){let n=t[0];for(let i=1;i<t.length;i++){const r=t[i];e(n)>e(r)&&(n=r)}return n}function De(t,e){const n=jt(t,r=>r.length),i=[];for(const r of n)t.some(o=>o.findIndex(a=>e(a)===e(r))===-1)||i.push(r);return i}async function Tt(t){return!await ue(t,D,W)}async function St(t,e,n){const[i,r]=await Promise.all([ne,W].map(o=>ue(t,D,o)));return i===n&&r===e}async function xt(t,e){return _(t,A,O,(i,r,o)=>{let a;const m=()=>{i.getAll(a&&IDBKeyRange.lowerBound(a,!0),50).onsuccess=f=>{const c=f.target.result;for(const l of c)if(a=l.unicode,e(l))return o(l);if(c.length<50)return o();m()}};m()})}async function Oe(t,e,n,i){try{const r=wt(e);await _(t,[A,D],ce,([o,a],m)=>{let f,c,l=0;function p(){++l===2&&u()}function u(){if(!(f===i&&c===n)){o.clear();for(const b of r)o.put(b);a.put(i,ne),a.put(n,W),le(m)}}I(a,ne,b=>{f=b,p()}),I(a,W,b=>{c=b,p()})})}finally{}}async function Ct(t,e){return _(t,A,O,(n,i,r)=>{const o=IDBKeyRange.bound([e,0],[e+1,0],!1,!0);Le(n.index(xe),o,r)})}async function $e(t,e){const n=Ie(L(e));return n.length?_(t,A,O,(i,r,o)=>{const a=[],m=()=>{a.length===n.length&&f()},f=()=>{const c=De(a,l=>l.unicode);o(c.sort((l,p)=>l.order<p.order?-1:1))};for(let c=0;c<n.length;c++){const l=n[c],p=c===n.length-1?IDBKeyRange.bound(l,l+"Ôøø",!1,!0):IDBKeyRange.only(l);Le(i.index(Te),p,u=>{a.push(u),m()})}}):[]}async function _t(t,e){const n=await $e(t,e);return n.length?n.filter(i=>(i.shortcodes||[]).map(o=>o.toLowerCase()).includes(e.toLowerCase()))[0]||null:await xt(t,r=>(r.shortcodes||[]).includes(e.toLowerCase()))||null}async function It(t,e){return _(t,A,O,(n,i,r)=>I(n,e,o=>{if(o)return r(o);I(n.index(Ce),e,a=>r(a||null))}))}function ue(t,e,n){return _(t,e,O,(i,r,o)=>I(i,n,o))}function At(t,e,n,i){return _(t,e,ce,(r,o)=>{r.put(i,n),le(o)})}function Lt(t,e){return _(t,ae,ce,(n,i)=>I(n,e,r=>{n.put((r||0)+1,e),le(i)}))}function Dt(t,e,n){return n===0?[]:_(t,[ae,A],O,([i,r],o,a)=>{const m=[];i.index(Se).openCursor(void 0,"prev").onsuccess=f=>{const c=f.target.result;if(!c)return a(m);function l(b){if(m.push(b),m.length===n)return a(m);c.continue()}const p=c.primaryKey,u=e.byName(p);if(u)return l(u);I(r,p,b=>{if(b)return l(b);c.continue()})}})}const N="";function Ot(t,e){const n=new Map;for(const r of t){const o=e(r);for(const a of o){let m=n;for(let c=0;c<a.length;c++){const l=a.charAt(c);let p=m.get(l);p||(p=new Map,m.set(l,p)),m=p}let f=m.get(N);f||(f=[],m.set(N,f)),f.push(r)}}return(r,o)=>{let a=n;for(let c=0;c<r.length;c++){const l=r.charAt(c),p=a.get(l);if(p)a=p;else return[]}if(o)return a.get(N)||[];const m=[],f=[a];for(;f.length;){const l=[...f.shift().entries()].sort((p,u)=>p[0]<u[0]?-1:1);for(const[p,u]of l)p===N?m.push(...u):f.push(u)}return m}}const $t=["name","url"];function Mt(t){const e=t&&Array.isArray(t),n=e&&t.length&&(!t[0]||$t.some(i=>!(i in t[0])));if(!e||n)throw new Error("Custom emojis are in the wrong format")}function ye(t){Mt(t);const e=(u,b)=>u.name.toLowerCase()<b.name.toLowerCase()?-1:1,n=t.sort(e),r=Ot(t,u=>[...new Set((u.shortcodes||[]).map(b=>L(b)).flat())]),o=u=>r(u,!0),a=u=>r(u,!1),m=u=>{const b=L(u),C=b.map((j,k)=>(k<b.length-1?o:a)(j));return De(C,j=>j.name).sort(e)},f=new Map,c=new Map;for(const u of t){c.set(u.name.toLowerCase(),u);for(const b of u.shortcodes||[])f.set(b.toLowerCase(),u)}return{all:n,search:m,byShortcode:u=>f.get(u.toLowerCase()),byName:u=>c.get(u.toLowerCase())}}const Bt=typeof wrappedJSObject<"u";function $(t){if(!t)return t;if(Bt&&(t=structuredClone(t)),delete t.tokens,t.skinTones){const e=t.skinTones.length;t.skins=Array(e);for(let n=0;n<e;n++)t.skins[n]={tone:t.skinTones[n],unicode:t.skinUnicodes[n],version:t.skinVersions[n]};delete t.skinTones,delete t.skinUnicodes,delete t.skinVersions}return t}function Me(t){t||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Ft=["annotation","emoji","group","order","tags","version"];function Rt(t){if(!t||!Array.isArray(t)||!t[0]||typeof t[0]!="object"||Ft.some(e=>!(e in t[0])))throw new Error("Emoji data is in the wrong format")}function Be(t,e){if(Math.floor(t.status/100)!==2)throw new Error("Failed to fetch: "+e+":  "+t.status)}async function Nt(t){const e=await fetch(t,{method:"HEAD"});Be(e,t);const n=e.headers.get("etag");return Me(n),n}async function ie(t){const e=await fetch(t);Be(e,t);const n=e.headers.get("etag");Me(n);const i=await e.json();return Rt(i),[n,i]}function Pt(t){for(var e="",n=new Uint8Array(t),i=n.byteLength,r=-1;++r<i;)e+=String.fromCharCode(n[r]);return e}function zt(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=-1;++r<e;)i[r]=t.charCodeAt(r);return n}async function Fe(t){const e=JSON.stringify(t);let n=zt(e);const i=await crypto.subtle.digest("SHA-1",n),r=Pt(i);return btoa(r)}async function Ut(t,e){let n,i=await Nt(e);if(!i){const r=await ie(e);i=r[0],n=r[1],i||(i=await Fe(n))}await St(t,e,i)||(n||(n=(await ie(e))[1]),await Oe(t,n,e,i))}async function Wt(t,e){let[n,i]=await ie(e);n||(n=await Fe(i)),await Oe(t,i,e,n)}class Gt{constructor({dataSource:e=ft,locale:n=mt,customEmoji:i=[]}={}){this.dataSource=e,this.locale=n,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=ye(i),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await bt(this._dbName);kt(this._dbName,this._clear);const n=this.dataSource;await Tt(e)?await Wt(e,n):this._lazyUpdate=Ut(e,n)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return q(e),await this.ready(),be(await Ct(this._db,e)).map($)}async getEmojiBySearchQuery(e){R(e),await this.ready();const n=this._custom.search(e),i=be(await $e(this._db,e)).map($);return[...n,...i]}async getEmojiByShortcode(e){R(e),await this.ready();const n=this._custom.byShortcode(e);return n||$(await _t(this._db,e))}async getEmojiByUnicodeOrName(e){R(e),await this.ready();const n=this._custom.byName(e);return n||$(await It(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await ue(this._db,D,ge)||0}async setPreferredSkinTone(e){return q(e),await this.ready(),At(this._db,D,ge,e)}async incrementFavoriteEmojiCount(e){return R(e),await this.ready(),Lt(this._db,e)}async getTopFavoriteEmoji(e){return q(e),await this.ready(),(await Dt(this._db,this._custom,e)).map($)}set customEmoji(e){this._custom=ye(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await de(this._dbName)}async delete(){await this._shutdown(),await yt(this._dbName)}}const re=[[-1,"‚ú®","custom"],[0,"üòÄ","smileys-emotion"],[1,"üëã","people-body"],[3,"üê±","animals-nature"],[4,"üçé","food-drink"],[5,"üè†Ô∏è","travel-places"],[6,"‚öΩ","activities"],[7,"üìù","objects"],[8,"‚õîÔ∏è","symbols"],[9,"üèÅ","flags"]].map(([t,e,n])=>({id:t,emoji:e,name:n})),X=re.slice(1),Kt=2,ke=6,Re=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function Ee(t){return t.unicode.includes("‚Äç")}const Vt={"ü´®":15.1,"ü´†":14,"ü•≤":13.1,"ü•ª":12.1,"ü•∞":11,"ü§©":5,"üë±‚Äç‚ôÄÔ∏è":4,"ü§£":3,"üëÅÔ∏è‚Äçüó®Ô∏è":2,"üòÄ":1,"üòêÔ∏è":.7,"üòÉ":.6},Ht=1e3,qt="üñêÔ∏è",Xt=8,Yt=["üòä","üòí","‚ù§Ô∏è","üëçÔ∏è","üòç","üòÇ","üò≠","‚ò∫Ô∏è","üòî","üò©","üòè","üíï","üôå","üòò"],Ne='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',Zt=(t,e)=>t<e?-1:t>e?1:0,ve=(t,e)=>{const n=document.createElement("canvas");n.width=n.height=1;const i=n.getContext("2d");return i.textBaseline="top",i.font=`100px ${Ne}`,i.fillStyle=e,i.scale(.01,.01),i.fillText(t,0,0),i.getImageData(0,0,1,1).data},Jt=(t,e)=>{const n=[...t].join(","),i=[...e].join(",");return n===i&&!n.startsWith("0,0,0,")};function Qt(t){const e=ve(t,"#000"),n=ve(t,"#fff");return e&&n&&Jt(e,n)}function en(){const t=Object.entries(Vt);try{for(const[e,n]of t)if(Qt(e))return n}catch{}finally{}return t[0][1]}let Y;const Z=()=>(Y||(Y=new Promise(t=>Re(()=>t(en())))),Y),se=new Map,tn="Ô∏è",nn="\uD83C",on="‚Äç",rn=127995,sn=57339;function an(t,e){if(e===0)return t;const n=t.indexOf(on);return n!==-1?t.substring(0,n)+String.fromCodePoint(rn+e-1)+t.substring(n):(t.endsWith(tn)&&(t=t.substring(0,t.length-1)),t+nn+String.fromCodePoint(sn+e-1))}function x(t){t.preventDefault(),t.stopPropagation()}function J(t,e,n){return e+=t?-1:1,e<0?e=n.length-1:e>=n.length&&(e=0),e}function Pe(t,e){const n=new Set,i=[];for(const r of t){const o=e(r);n.has(o)||(n.add(o),i.push(r))}return i}function cn(t,e){const n=i=>{const r={};for(const o of i)typeof o.tone=="number"&&o.version<=e&&(r[o.tone]=o.unicode);return r};return t.map(({unicode:i,skins:r,shortcodes:o,url:a,name:m,category:f,annotation:c})=>({unicode:i,name:m,shortcodes:o,url:a,category:f,annotation:c,id:i||m,skins:r&&n(r)}))}const U=requestAnimationFrame;let dn=typeof ResizeObserver=="function";function ln(t,e,n){let i;dn?(i=new ResizeObserver(r=>n(r[0].contentRect.width)),i.observe(t)):U(()=>n(t.getBoundingClientRect().width)),e.addEventListener("abort",()=>{i&&i.disconnect()})}function we(t){{const e=document.createRange();return e.selectNode(t.firstChild),e.getBoundingClientRect().width}}let Q;function un(t,e,n){for(const i of t){const r=n(i),o=we(r);typeof Q>"u"&&(Q=we(e));const a=o/1.8<Q;se.set(i.unicode,a)}}function fn(t){return Pe(t,e=>e)}function mn(t){t&&(t.scrollTop=0)}function M(t,e,n){let i=t.get(e);return i||(i=n(),t.set(e,i)),i}function je(t){return""+t}function pn(t){const e=document.createElement("template");return e.innerHTML=t,e}const hn=new WeakMap,gn=new WeakMap,bn=Symbol("un-keyed"),yn="replaceChildren"in Element.prototype;function kn(t,e){yn?t.replaceChildren(...e):(t.innerHTML="",t.append(...e))}function En(t,e){let n=t.firstChild,i=0;for(;n;){if(e[i]!==n)return!0;n=n.nextSibling,i++}return i!==e.length}function vn(t,e){const{targetNode:n}=e;let{targetParentNode:i}=e,r=!1;i?r=En(i,t):(r=!0,e.targetNode=void 0,e.targetParentNode=i=n.parentNode),r&&kn(i,t)}function wn(t,e){for(const n of e){const{targetNode:i,currentExpression:r,binding:{expressionIndex:o,attributeName:a,attributeValuePre:m,attributeValuePost:f}}=n,c=t[o];if(r!==c)if(n.currentExpression=c,a)i.setAttribute(a,m+je(c)+f);else{let l;Array.isArray(c)?vn(c,n):c instanceof Element?(l=c,i.replaceWith(l)):i.nodeValue=je(c),l&&(n.targetNode=l)}}}function jn(t){let e="",n=!1,i=!1,r=-1;const o=new Map,a=[];for(let f=0,c=t.length;f<c;f++){const l=t[f];if(e+=l,f===c-1)break;for(let y=0;y<l.length;y++)switch(l.charAt(y)){case"<":{l.charAt(y+1)==="/"?a.pop():(n=!0,a.push(++r));break}case">":{n=!1,i=!1;break}case"=":{i=!0;break}}const p=a[a.length-1],u=M(o,p,()=>[]);let b,C,j;if(i){const y=/(\S+)="?([^"=]*)$/.exec(l);b=y[1],C=y[2],j=/^[^">]*/.exec(t[f+1])[0]}const k={attributeName:b,attributeValuePre:C,attributeValuePost:j,expressionIndex:f};u.push(k),!n&&!i&&(e+=" ")}return{template:pn(e),elementsToBindings:o}}function Tn(t,e){const n=[],i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT);let r=t,o=-1;do{const a=e.get(++o);if(a)for(let m=0;m<a.length;m++){const f=a[m],c=f.attributeName?r:r.firstChild,l={binding:f,targetNode:c,targetParentNode:void 0,currentExpression:void 0};n.push(l)}}while(r=i.nextNode());return n}function Sn(t){const{template:e,elementsToBindings:n}=M(hn,t,()=>jn(t)),i=e.cloneNode(!0).content.firstElementChild,r=Tn(i,n);return function(a){return wn(a,r),i}}function xn(t){const e=M(gn,t,()=>new Map);let n=bn;function i(o,...a){const m=M(e,o,()=>new Map);return M(m,n,()=>Sn(o))(a)}function r(o,a,m){return o.map((f,c)=>{const l=n;n=m(f);try{return a(f,c)}finally{n=l}})}return{map:r,html:i}}function Cn(t,e,n,i,r,o,a,m){const{labelWithSkin:f,titleForEmoji:c,unicodeWithSkin:l}=n,{html:p,map:u}=xn(e);function b(k,y,T){return u(k,(w,B)=>p`<button role="${y?"option":"menuitem"}" aria-selected="${e.searchMode?B===e.activeSearchItem:""}" aria-label="${f(w,e.currentSkinTone)}" title="${c(w)}" class="emoji ${y&&B===e.activeSearchItem?"active":""}" id="${`${T}-${w.id}`}">${w.unicode?l(w,e.currentSkinTone):p`<img class="custom-emoji" src="${w.url}" alt="" loading="lazy">`}</button>`,w=>`${T}-${w.id}`)}const j=(()=>p`<section data-ref="rootElement" class="picker" aria-label="${e.i18n.regionLabel}" style="${e.pickerStyle}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${e.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!!(e.searchMode&&e.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${e.activeSearchItemId?`emo-${e.activeSearchItemId}`:""}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">${e.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${e.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${e.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${e.skinTonePickerExpanded?"hide-focus":""}" aria-label="${e.skinToneButtonLabel}" title="${e.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${e.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${e.skinToneButtonText}</button></div><span id="skintone-description" class="sr-only">${e.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${e.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${e.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${e.i18n.skinTonesLabel}" aria-activedescendant="skintone-${e.activeSkinTone}" aria-hidden="${!e.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${u(e.skinTones,(k,y)=>p`<div id="skintone-${y}" class="emoji ${y===e.activeSkinTone?"active":""}" aria-selected="${y===e.activeSkinTone}" role="option" title="${e.i18n.skinTones[y]}" aria-label="${e.i18n.skinTones[y]}">${k}</div>`,k=>k)}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${e.groups.length},1fr)" aria-label="${e.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${u(e.groups,k=>p`<button role="tab" class="nav-button" aria-controls="tab-${k.id}" aria-label="${e.i18n.categories[k.name]}" aria-selected="${!e.searchMode&&e.currentGroup.id===k.id}" title="${e.i18n.categories[k.name]}" data-group-id="${k.id}"><div class="nav-emoji emoji">${k.emoji}</div></button>`,k=>k.id)}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(e.isRtl?-1:1)*e.currentGroupIndex*100}%)"></div></div><div class="message ${e.message?"":"gone"}" role="alert" aria-live="polite">${e.message}</div><div data-ref="tabpanelElement" class="tabpanel ${!e.databaseLoaded||e.message?"gone":""}" role="${e.searchMode?"region":"tabpanel"}" aria-label="${e.searchMode?e.i18n.searchResultsLabel:e.i18n.categories[e.currentGroup.name]}" id="${e.searchMode?"":`tab-${e.currentGroup.id}`}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${u(e.currentEmojisWithCategories,(k,y)=>p`<div><div id="menu-label-${y}" class="category ${e.currentEmojisWithCategories.length===1&&e.currentEmojisWithCategories[0].category===""?"gone":""}" aria-hidden="true">${e.searchMode?e.i18n.searchResultsLabel:k.category?k.category:e.currentEmojisWithCategories.length>1?e.i18n.categories.custom:e.i18n.categories[e.currentGroup.name]}</div><div class="emoji-menu" role="${e.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${y}" id="${e.searchMode?"search-results":""}">${b(k.emojis,e.searchMode,"emo")}</div></div>`,k=>k.category)}</div></div><div class="favorites emoji-menu ${e.message?"gone":""}" role="menu" aria-label="${e.i18n.favoritesLabel}" style="padding-inline-end:${`${e.scrollbarWidth}px`}" data-on-click="onEmojiClick">${b(e.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">üòÄ</button></section>`)();if(m){t.appendChild(j);const k=(y,T)=>{for(const w of t.querySelectorAll(`[${y}]`))T(w,w.getAttribute(y))};for(const y of["click","focusout","input","keydown","keyup"])k(`data-on-${y}`,(T,w)=>{T.addEventListener(y,i[w])});k("data-ref",(y,T)=>{o[T]=y}),k("data-action",(y,T)=>{r[T](y)}),a.addEventListener("abort",()=>{t.removeChild(j)})}}const K=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t);function _n(t){let e=!1,n;const i=new Map,r=new Set;let o;const a=()=>{if(e)return;const c=[...r];r.clear();try{for(const l of c)l()}finally{o=!1,r.size&&(o=!0,K(a))}},m=new Proxy({},{get(c,l){if(n){let p=i.get(l);p||(p=new Set,i.set(l,p)),p.add(n)}return c[l]},set(c,l,p){c[l]=p;const u=i.get(l);if(u){for(const b of u)r.add(b);o||(o=!0,K(a))}return!0}}),f=c=>{const l=()=>{const p=n;n=l;try{return c()}finally{n=p}};return l()};return t.addEventListener("abort",()=>{e=!0}),{state:m,createEffect:f}}function ee(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}const te=[],{assign:P}=Object;function In(t,e){const n={},i=new AbortController,r=i.signal,{state:o,createEffect:a}=_n(r);P(o,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),P(o,e),P(o,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:Xt,isRtl:!1,scrollbarWidth:0,currentGroupIndex:0,groups:X,databaseLoaded:!1,activeSearchItemId:void 0}),a(()=>{o.currentGroup!==o.groups[o.currentGroupIndex]&&(o.currentGroup=o.groups[o.currentGroupIndex])});const m=s=>{t.getElementById(s).focus()},f=s=>t.getElementById(`emo-${s.id}`),c=(s,d)=>{n.rootElement.dispatchEvent(new CustomEvent(s,{detail:d,bubbles:!0,composed:!0}))},l=(s,d)=>s.id===d.id,p=(s,d)=>{const{category:h,emojis:g}=s,{category:E,emojis:v}=d;return h!==E?!1:ee(g,v,l)},u=s=>{ee(o.currentEmojis,s,l)||(o.currentEmojis=s)},b=s=>{o.searchMode!==s&&(o.searchMode=s)},C=s=>{ee(o.currentEmojisWithCategories,s,p)||(o.currentEmojisWithCategories=s)},j=(s,d)=>d&&s.skins&&s.skins[d]||s.unicode,T={labelWithSkin:(s,d)=>fn([s.name||j(s,d),s.annotation,...s.shortcodes||te].filter(Boolean)).join(", "),titleForEmoji:s=>s.annotation||(s.shortcodes||te).join(", "),unicodeWithSkin:j},w={onClickSkinToneButton:et,onEmojiClick:Je,onNavClick:Ye,onNavKeydown:Ze,onSearchKeydown:Xe,onSkinToneOptionsClick:Qe,onSkinToneOptionsFocusOut:ot,onSkinToneOptionsKeydown:tt,onSkinToneOptionsKeyup:nt,onSearchInput:it},B={calculateEmojiGridStyle:Ge};let fe=!0;a(()=>{Cn(t,o,T,w,B,n,r,fe),fe=!1}),o.emojiVersion||Z().then(s=>{s||(o.message=o.i18n.emojiUnsupportedMessage)}),a(()=>{async function s(){let d=!1;const h=setTimeout(()=>{d=!0,o.message=o.i18n.loadingMessage},Ht);try{await o.database.ready(),o.databaseLoaded=!0}catch(g){console.error(g),o.message=o.i18n.networkErrorMessage}finally{clearTimeout(h),d&&(d=!1,o.message="")}}o.database&&s()}),a(()=>{o.pickerStyle=`
      --num-groups: ${o.groups.length}; 
      --indicator-opacity: ${o.searchMode?0:1}; 
      --num-skintones: ${ke};`}),a(()=>{o.customEmoji&&o.database&&me()}),a(()=>{o.customEmoji&&o.customEmoji.length?o.groups!==re&&(o.groups=re):o.groups!==X&&(o.currentGroupIndex&&o.currentGroupIndex--,o.groups=X)}),a(()=>{async function s(){o.databaseLoaded&&(o.currentSkinTone=await o.database.getPreferredSkinTone())}s()}),a(()=>{o.skinTones=Array(ke).fill().map((s,d)=>an(o.skinToneEmoji,d))}),a(()=>{o.skinToneButtonText=o.skinTones[o.currentSkinTone]}),a(()=>{o.skinToneButtonLabel=o.i18n.skinToneLabel.replace("{skinTone}",o.i18n.skinTones[o.currentSkinTone])}),a(()=>{async function s(){const{database:d}=o,h=(await Promise.all(Yt.map(g=>d.getEmojiByUnicodeOrName(g)))).filter(Boolean);o.defaultFavoriteEmojis=h}o.databaseLoaded&&s()});function me(){o.database.customEmoji=o.customEmoji||te}a(()=>{async function s(){me();const{database:d,defaultFavoriteEmojis:h,numColumns:g}=o,E=await d.getTopFavoriteEmoji(g),v=await V(Pe([...E,...h],S=>S.unicode||S.name).slice(0,g));o.currentFavorites=v}o.databaseLoaded&&o.defaultFavoriteEmojis&&s()});function Ge(s){ln(s,r,d=>{{const h=getComputedStyle(n.rootElement),g=parseInt(h.getPropertyValue("--num-columns"),10),E=h.getPropertyValue("direction")==="rtl",S=s.parentElement.getBoundingClientRect().width-d;o.numColumns=g,o.scrollbarWidth=S,o.isRtl=E}})}a(()=>{async function s(){const{searchText:d,currentGroup:h,databaseLoaded:g,customEmoji:E}=o;if(!g)o.currentEmojis=[],o.searchMode=!1;else if(d.length>=Kt){const v=await qe(d);o.searchText===d&&(u(v),b(!0))}else{const{id:v}=h;if(v!==-1||E&&E.length){const S=await He(v);o.currentGroup.id===v&&(u(S),b(!1))}}}s()}),a(()=>{const{currentEmojis:s,emojiVersion:d}=o,h=s.filter(g=>g.unicode).filter(g=>Ee(g)&&!se.has(g.unicode));if(!d&&h.length)u(s),U(()=>Ke(h));else{const g=d?s:s.filter(Ve);u(g),U(()=>mn(n.tabpanelElement))}});function Ke(s){un(s,n.baselineEmoji,f),o.currentEmojis=o.currentEmojis}function Ve(s){return!s.unicode||!Ee(s)||se.get(s.unicode)}async function pe(s){const d=o.emojiVersion||await Z();return s.filter(({version:h})=>!h||h<=d)}async function V(s){return cn(s,o.emojiVersion||await Z())}async function He(s){const d=s===-1?o.customEmoji:await o.database.getEmojiByGroup(s);return V(await pe(d))}async function qe(s){return V(await pe(await o.database.getEmojiBySearchQuery(s)))}a(()=>{}),a(()=>{function s(){const{searchMode:h,currentEmojis:g}=o;if(h)return[{category:"",emojis:g}];const E=new Map;for(const v of g){const S=v.category||"";let F=E.get(S);F||(F=[],E.set(S,F)),F.push(v)}return[...E.entries()].map(([v,S])=>({category:v,emojis:S})).sort((v,S)=>o.customCategorySorting(v.category,S.category))}const d=s();C(d)}),a(()=>{o.activeSearchItemId=o.activeSearchItem!==-1&&o.currentEmojis[o.activeSearchItem].id}),a(()=>{const{rawSearchText:s}=o;Re(()=>{o.searchText=(s||"").trim(),o.activeSearchItem=-1})});function Xe(s){if(!o.searchMode||!o.currentEmojis.length)return;const d=h=>{x(s),o.activeSearchItem=J(h,o.activeSearchItem,o.currentEmojis)};switch(s.key){case"ArrowDown":return d(!1);case"ArrowUp":return d(!0);case"Enter":if(o.activeSearchItem===-1)o.activeSearchItem=0;else return x(s),he(o.currentEmojis[o.activeSearchItem].id)}}function Ye(s){const{target:d}=s,h=d.closest(".nav-button");if(!h)return;const g=parseInt(h.dataset.groupId,10);n.searchElement.value="",o.rawSearchText="",o.searchText="",o.activeSearchItem=-1,o.currentGroupIndex=o.groups.findIndex(E=>E.id===g)}function Ze(s){const{target:d,key:h}=s,g=E=>{E&&(x(s),E.focus())};switch(h){case"ArrowLeft":return g(d.previousElementSibling);case"ArrowRight":return g(d.nextElementSibling);case"Home":return g(d.parentElement.firstElementChild);case"End":return g(d.parentElement.lastElementChild)}}async function he(s){const d=await o.database.getEmojiByUnicodeOrName(s),h=[...o.currentEmojis,...o.currentFavorites].find(E=>E.id===s),g=h.unicode&&j(h,o.currentSkinTone);await o.database.incrementFavoriteEmojiCount(s),c("emoji-click",{emoji:d,skinTone:o.currentSkinTone,...g&&{unicode:g},...h.name&&{name:h.name}})}async function Je(s){const{target:d}=s;if(!d.classList.contains("emoji"))return;x(s);const h=d.id.substring(4);he(h)}function H(s){o.currentSkinTone=s,o.skinTonePickerExpanded=!1,m("skintone-button"),c("skin-tone-change",{skinTone:s}),o.database.setPreferredSkinTone(s)}function Qe(s){const{target:{id:d}}=s,h=d&&d.match(/^skintone-(\d)/);if(!h)return;x(s);const g=parseInt(h[1],10);H(g)}function et(s){o.skinTonePickerExpanded=!o.skinTonePickerExpanded,o.activeSkinTone=o.currentSkinTone,o.skinTonePickerExpanded&&(x(s),U(()=>m("skintone-list")))}a(()=>{o.skinTonePickerExpanded?n.skinToneDropdown.addEventListener("transitionend",()=>{o.skinTonePickerExpandedAfterAnimation=!0},{once:!0}):o.skinTonePickerExpandedAfterAnimation=!1});function tt(s){if(!o.skinTonePickerExpanded)return;const d=async h=>{x(s),o.activeSkinTone=h};switch(s.key){case"ArrowUp":return d(J(!0,o.activeSkinTone,o.skinTones));case"ArrowDown":return d(J(!1,o.activeSkinTone,o.skinTones));case"Home":return d(0);case"End":return d(o.skinTones.length-1);case"Enter":return x(s),H(o.activeSkinTone);case"Escape":return x(s),o.skinTonePickerExpanded=!1,m("skintone-button")}}function nt(s){if(o.skinTonePickerExpanded)switch(s.key){case" ":return x(s),H(o.activeSkinTone)}}async function ot(s){const{relatedTarget:d}=s;(!d||d.id!=="skintone-list")&&(o.skinTonePickerExpanded=!1)}function it(s){o.rawSearchText=s.target.value}return{$set(s){P(o,s)},$destroy(){i.abort()}}}const An="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Ln="en";var Dn={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading‚Ä¶",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}},On=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}";const ze=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],$n=`:host{--emoji-font-family:${Ne}}`;class Ue extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const n=document.createElement("style");n.textContent=On+$n,this.shadowRoot.appendChild(n),this._ctx={locale:Ln,dataSource:An,skinToneEmoji:qt,customCategorySorting:Zt,customEmoji:null,i18n:Dn,emojiVersion:null,...e};for(const i of ze)i!=="database"&&Object.prototype.hasOwnProperty.call(this,i)&&(this._ctx[i]=this[i],delete this[i]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=In(this.shadowRoot,this._ctx))}disconnectedCallback(){K(()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e.close().catch(n=>console.error(n))}})}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(e,n,i){this._set(e.replace(/-([a-z])/g,(r,o)=>o.toUpperCase()),e==="emoji-version"?parseFloat(i):i)}_set(e,n){this._ctx[e]=n,this._cmp&&this._cmp.$set({[e]:n}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:n,database:i}=this._ctx;(!i||i.locale!==e||i.dataSource!==n)&&this._set("database",new Gt({locale:e,dataSource:n}))}_dbFlush(){K(()=>this._dbCreate())}}const We={};for(const t of ze)We[t]={get(){return t==="database"&&this._dbCreate(),this._ctx[t]},set(e){if(t==="database")throw new Error("database is read-only");this._set(t,e)}};Object.defineProperties(Ue.prototype,We);customElements.get("emoji-picker")||customElements.define("emoji-picker",Ue);export{Ue as P};
